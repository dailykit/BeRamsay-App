{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import React,{PureComponent}from\"react\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Animated from\"react-native-web/dist/exports/Animated\";import Dimensions from\"react-native-web/dist/exports/Dimensions\";import Platform from\"react-native-web/dist/exports/Platform\";import View from\"react-native-web/dist/exports/View\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import styles from\"./storiesStyles\";import StoryItem from\"../../storyItem/view/storyItemView\";var _Dimensions$get=Dimensions.get(\"window\"),width=_Dimensions$get.width;var perspective=width;var angle=Math.atan(perspective/(width/2));var ratio=Platform.OS===\"ios\"?2:1.2;var Stories=function(_PureComponent){_inherits(Stories,_PureComponent);function Stories(props){var _this;_classCallCheck(this,Stories);_this=_possibleConstructorReturn(this,_getPrototypeOf(Stories).call(this,props));_this.stories=[];_this.state={x:new Animated.Value(0),ready:false};_this._handleSelectedStoryOnLoaded=function(){_this.setState({ready:true});};_this._handleSwipeLeftRight=function(){alert(\"swipe\");};_this.stories=props.stories.map(function(){return React.createRef();});return _this;}_createClass(Stories,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var x;return _regeneratorRuntime.async(function componentDidMount$(_context){while(1){switch(_context.prev=_context.next){case 0:x=this.state.x;_context.next=3;return _regeneratorRuntime.awrap(x.addListener(function(){return _this2.stories.forEach(function(story,index){var offset=index*width;var inputRange=[offset-width,offset+width];var translateX=x.interpolate({inputRange:inputRange,outputRange:[width/ratio,-width/ratio],extrapolate:\"clamp\"}).__getValue();var rotateY=x.interpolate({inputRange:inputRange,outputRange:[angle+\"rad\",\"-\"+angle+\"rad\"],extrapolate:\"clamp\"}).__getValue();var parsed=parseFloat(rotateY.substr(0,rotateY.indexOf(\"rad\")),10);var alpha=Math.abs(parsed);var gamma=angle-alpha;var beta=Math.PI-alpha-gamma;var w=width/2-width/2*Math.sin(gamma)/Math.sin(beta);var translateX2=parsed>0?w:-w;var style={transform:[{perspective:perspective},{translateX:translateX},{rotateY:rotateY},{translateX:translateX2}]};story.current.setNativeProps({style:style});});}));case 3:case\"end\":return _context.stop();}}},null,this);}},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,x=_this$state.x,ready=_this$state.ready;var _this$props=this.props,stories=_this$props.stories,selectedStory=_this$props.selectedStory,footerComponent=_this$props.footerComponent;return React.createElement(View,{style:styles.container},!ready&&React.createElement(View,{style:{flex:1,zIndex:9999,justifyContent:\"center\",alignItems:\"center\",backgroundColor:\"white\"}},React.createElement(ActivityIndicator,{size:\"large\",color:\"gray\"})),stories.map(function(story,i){return React.createElement(Animated.View,{ref:_this3.stories[i],style:StyleSheet.absoluteFill,key:story.id},React.createElement(StoryItem,_extends({footerComponent:footerComponent,handleSelectedStoryOnLoaded:_this3._handleSelectedStoryOnLoaded,selectedStory:selectedStory},{story:story})));}).reverse(),React.createElement(Animated.ScrollView,{ref:this.scroll,style:StyleSheet.absoluteFillObject,showsHorizontalScrollIndicator:false,scrollEventThrottle:16,snapToInterval:width,contentContainerStyle:{width:width*stories.length},onScroll:Animated.event([{nativeEvent:{contentOffset:{x:x}}}],{useNativeDriver:true}),decelerationRate:0.99,horizontal:true}));}}]);return Stories;}(PureComponent);export{Stories as default};","map":{"version":3,"sources":["D:/New Projects/BeRamsayApp/components/stories/components/stories/view/storiesView.js"],"names":["React","PureComponent","styles","StoryItem","Dimensions","get","width","perspective","angle","Math","atan","ratio","Platform","OS","Stories","props","stories","state","x","Animated","Value","ready","_handleSelectedStoryOnLoaded","setState","_handleSwipeLeftRight","alert","map","createRef","addListener","forEach","story","index","offset","inputRange","translateX","interpolate","outputRange","extrapolate","__getValue","rotateY","parsed","parseFloat","substr","indexOf","alpha","abs","gamma","beta","PI","w","sin","translateX2","style","transform","current","setNativeProps","selectedStory","footerComponent","container","flex","zIndex","justifyContent","alignItems","backgroundColor","i","StyleSheet","absoluteFill","id","reverse","scroll","absoluteFillObject","length","event","nativeEvent","contentOffset","useNativeDriver"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\";\nimport {\n  StyleSheet,\n  Animated,\n  Dimensions,\n  Platform,\n  View,\n  ActivityIndicator\n} from \"react-native\";\nimport styles from \"./storiesStyles\";\nimport StoryItem from \"../../storyItem/view/storyItemView\";\n\nconst { width } = Dimensions.get(\"window\");\nconst perspective = width;\nconst angle = Math.atan(perspective / (width / 2));\nconst ratio = Platform.OS === \"ios\" ? 2 : 1.2;\n\nexport default class Stories extends PureComponent {\n  stories = [];\n\n  state = {\n    x: new Animated.Value(0),\n    ready: false\n  };\n\n  constructor(props) {\n    super(props);\n    this.stories = props.stories.map(() => React.createRef());\n  }\n\n  async componentDidMount() {\n    const { x } = this.state;\n    await x.addListener(() =>\n      this.stories.forEach((story, index) => {\n        const offset = index * width;\n        const inputRange = [offset - width, offset + width];\n        const translateX = x\n          .interpolate({\n            inputRange,\n            outputRange: [width / ratio, -width / ratio],\n            extrapolate: \"clamp\"\n          })\n          .__getValue();\n\n        const rotateY = x\n          .interpolate({\n            inputRange,\n            outputRange: [`${angle}rad`, `-${angle}rad`],\n            extrapolate: \"clamp\"\n          })\n          .__getValue();\n\n        const parsed = parseFloat(\n          rotateY.substr(0, rotateY.indexOf(\"rad\")),\n          10\n        );\n        const alpha = Math.abs(parsed);\n        const gamma = angle - alpha;\n        const beta = Math.PI - alpha - gamma;\n        const w = width / 2 - ((width / 2) * Math.sin(gamma)) / Math.sin(beta);\n        const translateX2 = parsed > 0 ? w : -w;\n\n        const style = {\n          transform: [\n            { perspective },\n            { translateX },\n            { rotateY },\n            { translateX: translateX2 }\n          ]\n        };\n        story.current.setNativeProps({ style });\n      })\n    );\n  }\n\n  _handleSelectedStoryOnLoaded = () => {\n    this.setState({ ready: true });\n  };\n\n  _handleSwipeLeftRight = () => {\n    alert(\"swipe\");\n  };\n\n  render() {\n    const { x, ready } = this.state;\n    const { stories, selectedStory, footerComponent } = this.props;\n\n    return (\n      <View style={styles.container}>\n        {!ready && (\n          <View\n            style={{\n              flex: 1,\n              zIndex: 9999,\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              backgroundColor: \"white\"\n            }}\n          >\n            <ActivityIndicator size=\"large\" color=\"gray\" />\n          </View>\n        )}\n        {stories\n          .map((story, i) => (\n            <Animated.View\n              ref={this.stories[i]}\n              style={StyleSheet.absoluteFill}\n              key={story.id}\n            >\n              <StoryItem\n                footerComponent={footerComponent}\n                handleSelectedStoryOnLoaded={this._handleSelectedStoryOnLoaded}\n                selectedStory={selectedStory}\n                {...{ story }}\n              />\n            </Animated.View>\n          ))\n          .reverse()}\n        <Animated.ScrollView\n          ref={this.scroll}\n          style={StyleSheet.absoluteFillObject}\n          showsHorizontalScrollIndicator={false}\n          scrollEventThrottle={16}\n          snapToInterval={width}\n          contentContainerStyle={{ width: width * stories.length }}\n          onScroll={Animated.event(\n            [\n              {\n                nativeEvent: {\n                  contentOffset: { x }\n                }\n              }\n            ],\n            { useNativeDriver: true }\n          )}\n          decelerationRate={0.99}\n          horizontal\n        />\n      </View>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}